{"componentChunkName":"component---src-templates-blog-post-js","path":"/SQL-5个核心SQL语句/","result":{"data":{"site":{"siteMetadata":{"title":"Lee Blog"}},"markdownRemark":{"id":"9392186b-9e34-587e-9ef1-290ba1520dfd","excerpt":"select select 语句用来从一个或多个表中或其他数据库对象中提取数据，一般的select语句就像这样： select列表列出查询的返回最终结果集中需要显示哪些列，这些列可以是数据表中一个实际的列、一个表达式、或者甚至是一个select语句的结果。 insert insert…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0652f08aba8e884528243d4783aef295/30a34/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.758693361433085%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7UlEQVQY02WPzUoCURiG504i6ga6AX8CRXIGCoXQhaCTBkIrdy3chKaizuiYjTo5JvkT1qrIjWvvpat4OmeU0Fq8vC/P+30f5yjh2gP50Tuau+CkYaMaPc7bAyL1LmfNx19pZt/rJI82bTSRpUeNzY7Mp1ULRTUdFss1n3qe23iSmOWQsJ+57LroTxNy7kz4lIyX56Sdicf14ZTscEZW9NLTzguhWgclaPQp3DXg8IDvo2Ou7RH1rxU341d8ZRP/fWtPga3+cn+5RbDSRvGJq+FihYF6QSmWJNUbU3z74Eq8IiAG5Df29I91djqLH61SxPEFE3R0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SQL Language Oracle\"\n        title=\"SQL Language Oracle\"\n        src=\"/static/0652f08aba8e884528243d4783aef295/799d3/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png\"\n        srcset=\"/static/0652f08aba8e884528243d4783aef295/00d96/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 148w,\n/static/0652f08aba8e884528243d4783aef295/0b23c/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 295w,\n/static/0652f08aba8e884528243d4783aef295/799d3/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 590w,\n/static/0652f08aba8e884528243d4783aef295/2a3d6/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 885w,\n/static/0652f08aba8e884528243d4783aef295/ae92f/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 1180w,\n/static/0652f08aba8e884528243d4783aef295/30a34/Screenshot_2020-01-31%20SQL%20Language%20Oracle.png 1898w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>select</h2>\n<p>select 语句用来从一个或多个表中或其他数据库对象中提取数据，一般的select语句就像这样：</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> c<span class=\"token punctuation\">.</span>customer_id<span class=\"token punctuation\">,</span> \n       <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>order_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> orders_ct\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>customers c\n<span class=\"token keyword\">join</span> oe<span class=\"token punctuation\">.</span>orders o\n<span class=\"token keyword\">on</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> o<span class=\"token punctuation\">.</span>customer_id\n<span class=\"token keyword\">where</span> c<span class=\"token punctuation\">.</span>gender <span class=\"token operator\">=</span> <span class=\"token string\">'F'</span>\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> c<span class=\"token punctuation\">.</span>customer_id\n<span class=\"token keyword\">having</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>order_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">4</span>\n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> orders_ct<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token punctuation\">;</span></code></pre></div>\n<p>select列表列出查询的返回最终结果集中需要显示哪些列，这些列可以是数据表中一个实际的列、一个表达式、<u>或者甚至是一个select语句的结果</u>。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> c<span class=\"token punctuation\">.</span>customer_id<span class=\"token punctuation\">,</span>\n       c<span class=\"token punctuation\">.</span>cust_first_name<span class=\"token operator\">||</span><span class=\"token string\">' '</span><span class=\"token operator\">||</span>c<span class=\"token punctuation\">.</span>cust_last_name<span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> e<span class=\"token punctuation\">.</span>last_name <span class=\"token keyword\">from</span> hr<span class=\"token punctuation\">.</span>employees e <span class=\"token keyword\">where</span> e<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>account_mgr_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> acct_mgr\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>customers c <span class=\"token punctuation\">;</span></code></pre></div>\n<h3>insert</h3>\n<p>insert语句用来向表、分区或视图中添加行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> hr<span class=\"token punctuation\">.</span>jobs j <span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>job_id<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>job_title<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>min_salary<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>max_salary<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">values</span><span class=\"token punctuation\">(</span><span class=\"token string\">'IT_PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Project Manager'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">rollback</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> scott<span class=\"token punctuation\">.</span>bonus <span class=\"token punctuation\">(</span>ename<span class=\"token punctuation\">,</span> job<span class=\"token punctuation\">,</span> sal<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">select</span> ename<span class=\"token punctuation\">,</span>\n       job<span class=\"token punctuation\">,</span> \n       sal <span class=\"token operator\">*</span> <span class=\"token number\">.10</span>\n<span class=\"token keyword\">from</span> scott<span class=\"token punctuation\">.</span>emp <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- 多表插入</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">all</span>\n<span class=\"token keyword\">when</span> sum_orders <span class=\"token operator\">&lt;</span> <span class=\"token number\">10000</span> <span class=\"token keyword\">then</span>\n<span class=\"token keyword\">into</span> small_customers\n<span class=\"token keyword\">when</span> sum_orders <span class=\"token operator\">>=</span> <span class=\"token number\">10000</span> <span class=\"token operator\">and</span> sum_orders <span class=\"token operator\">&lt;</span> <span class=\"token number\">100000</span> <span class=\"token keyword\">then</span>\n<span class=\"token keyword\">into</span> medium_customers\n<span class=\"token keyword\">else</span>\n<span class=\"token keyword\">into</span> large_customers\n<span class=\"token keyword\">select</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>order_total<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sum_orders\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>orders\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> customer_id <span class=\"token punctuation\">;</span></code></pre></div>\n<h3>update</h3>\n<p>update语句的作用是改变表中原有行的列值。这个语句的语法由3个部分组成：update、set和where。update子句用来指定要更新的表，set子句用来指明哪些列改变了以及调整的值，where子句用来按条件筛选需要更新的行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Example 1: Update a single column value using an expression</span>\n<span class=\"token keyword\">update</span> employees2\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> salary <span class=\"token operator\">*</span> <span class=\"token number\">1.10</span> <span class=\"token comment\">-- increase salary by 10%</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 2: Update a single column value using a subquery</span>\n<span class=\"token comment\">-- 可用于两表列数据同步</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> employees2<span class=\"token punctuation\">.</span>salary\n                <span class=\"token keyword\">from</span> employees2\n                <span class=\"token keyword\">where</span> employees2<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> employees<span class=\"token punctuation\">.</span>employee_id <span class=\"token comment\">-- 主键匹配</span>\n                <span class=\"token operator\">and</span> employees<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">!=</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">)</span> <span class=\"token comment\">--相同的不更新</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 3: Update single column using using subquery in WHERE clause to determine which rows to update</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> salary <span class=\"token operator\">*</span> <span class=\"token number\">1.10</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> department_id\n                          <span class=\"token keyword\">from</span> departments\n                          <span class=\"token keyword\">where</span> department_name <span class=\"token operator\">=</span> <span class=\"token string\">'EXecutive'</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 4: Update a table using a SELECT statement to define the table and column values</span>\n<span class=\"token keyword\">update</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> e1<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">,</span>\n               e2<span class=\"token punctuation\">.</span>salary <span class=\"token keyword\">as</span> new_sal<span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">from</span> employees e1<span class=\"token punctuation\">,</span> employees2 e2\n        <span class=\"token keyword\">where</span> e1<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> e2<span class=\"token punctuation\">.</span>employee_id\n          <span class=\"token operator\">and</span> e1<span class=\"token punctuation\">.</span>department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> new_sal <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 5: Update multiple columns using a subquery</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span>salary<span class=\"token punctuation\">,</span> commission_pct<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">,</span> <span class=\"token number\">.10</span> comm_pct\n                                  <span class=\"token keyword\">from</span> employees2\n                                  <span class=\"token keyword\">where</span> employees2<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> employees<span class=\"token punctuation\">.</span>emloyee_id\n                                    <span class=\"token operator\">and</span> employees<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">!=</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 比较Example 2、Example 4、Example 5。</span></code></pre></div>\n<h3>delete</h3>\n<p>delete语句用来从表中移除数据行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Example 1: Delete rows from specified table using a filter condition in the WHERE clause</span>\n<span class=\"token keyword\">delete</span> <span class=\"token keyword\">from</span> employees2\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">rollback</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 2: Delete rows suing a subquery in the FROM clause</span>\n<span class=\"token keyword\">delete</span> <span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> employees2 <span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">rollback</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 3: Delete rows from specified table using a subquery in the WHERE clause</span>\n<span class=\"token keyword\">delete</span> <span class=\"token keyword\">from</span> employees2\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> department_id\n                          <span class=\"token keyword\">from</span> departments\n                          <span class=\"token keyword\">where</span> department_name <span class=\"token operator\">=</span> <span class=\"token string\">'Executive'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">rollback</span> <span class=\"token punctuation\">;</span></code></pre></div>\n<h3>merge</h3>\n<p>merge语句可以按条件获取要更新或插入到表中的数据行，然后从1个或多个源头对表进行更新或者向表中插入行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 假设由两个表employees和dept60_bonuses，两表的数据如下</span>\n<span class=\"token keyword\">select</span> employee_id<span class=\"token punctuation\">,</span> last_name<span class=\"token punctuation\">,</span> salary \n<span class=\"token keyword\">from</span> employees \n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">60</span> <span class=\"token punctuation\">;</span>\n\nEMPLOYEE_ID     LAST_NAME     SALARY\n<span class=\"token comment\">------------------------------------</span>\n<span class=\"token number\">103</span>             Hunold        <span class=\"token number\">9000</span>\n<span class=\"token number\">104</span>             Ernst         <span class=\"token number\">6000</span>\n<span class=\"token number\">105</span>             Austin        <span class=\"token number\">4800</span>\n<span class=\"token number\">106</span>             Pataballa     <span class=\"token number\">4800</span>\n<span class=\"token number\">107</span>             Lorentz       <span class=\"token number\">4200</span>\n\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> dept60_bonuses <span class=\"token punctuation\">;</span>\n\nEMPLOYEE_ID     BONUS_AMT\n<span class=\"token comment\">-------------------------</span>\n<span class=\"token number\">103</span>             <span class=\"token number\">0</span>\n<span class=\"token number\">104</span>             <span class=\"token number\">100</span>\n<span class=\"token number\">105</span>             <span class=\"token number\">0</span>\n\n\n<span class=\"token keyword\">merge</span> <span class=\"token keyword\">into</span> dept60_bonuses b\n<span class=\"token keyword\">using</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">select</span> employee_id<span class=\"token punctuation\">,</span> salary<span class=\"token punctuation\">,</span> department_id\n        <span class=\"token keyword\">from</span> employees\n        <span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">60</span>\n      <span class=\"token punctuation\">)</span> e\n<span class=\"token keyword\">on</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>employee_id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">when</span> <span class=\"token keyword\">matched</span> <span class=\"token keyword\">then</span>\n  <span class=\"token keyword\">update</span> <span class=\"token keyword\">set</span> b<span class=\"token punctuation\">.</span>bonus_amt <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">*</span> <span class=\"token number\">0.2</span>\n  <span class=\"token keyword\">where</span> b<span class=\"token punctuation\">.</span>bonus_amt <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n  <span class=\"token keyword\">delete</span> <span class=\"token keyword\">where</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">></span> <span class=\"token number\">7500</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">when</span> <span class=\"token operator\">not</span> <span class=\"token keyword\">matched</span> <span class=\"token keyword\">then</span>\n  <span class=\"token keyword\">insert</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>employee_id<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">.</span>bonus_amt<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>employee_id<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">*</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">where</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">&lt;</span> <span class=\"token number\">7500</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> dept60_bonuses <span class=\"token punctuation\">;</span>\n\nEMPLOYEE_ID     BONUS_AMT\n<span class=\"token comment\">-------------------------</span>\n<span class=\"token number\">104</span>             <span class=\"token number\">100</span>\n<span class=\"token number\">105</span>             <span class=\"token number\">960</span>\n<span class=\"token number\">106</span>             <span class=\"token number\">480</span>\n<span class=\"token number\">107</span>             <span class=\"token number\">420</span></code></pre></div>","frontmatter":{"title":"5个核心SQL语句","los":"石林•昆明•云南•中国","date":"2020年01月27日","description":"This is a custom description for SEO and Open Graph purposes, rather than the default generated excerpt. Simply add a description field to the frontmatter."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/SQL-5个核心SQL语句/","previous":{"fields":{"slug":"/红楼梦-贾宝玉范的两个病/"},"frontmatter":{"title":"宝玉范的两个病"}},"next":{"fields":{"slug":"/SQL-SQL执行过程/"},"frontmatter":{"title":"SQL执行过程"}}}}}