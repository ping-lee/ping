{"componentChunkName":"component---src-templates-blog-post-js","path":"/SQL-5个核心SQL语句/","result":{"data":{"site":{"siteMetadata":{"title":"Lee Blog"}},"markdownRemark":{"id":"9392186b-9e34-587e-9ef1-290ba1520dfd","excerpt":"select select 语句用来从一个或多个表中或其他数据库对象中提取数据，一般的select语句就像这样： select列表列出查询的返回最终结果集中需要显示哪些列，这些列可以是数据表中一个实际的列、一个表达式、或者甚至是一个select语句的结果。 insert insert…","html":"<h2>select</h2>\n<p>select 语句用来从一个或多个表中或其他数据库对象中提取数据，一般的select语句就像这样：</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> c<span class=\"token punctuation\">.</span>customer_id<span class=\"token punctuation\">,</span> \n       <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>order_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> orders_ct\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>customers c\n<span class=\"token keyword\">join</span> oe<span class=\"token punctuation\">.</span>orders o\n<span class=\"token keyword\">on</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> o<span class=\"token punctuation\">.</span>customer_id\n<span class=\"token keyword\">where</span> c<span class=\"token punctuation\">.</span>gender <span class=\"token operator\">=</span> <span class=\"token string\">'F'</span>\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> c<span class=\"token punctuation\">.</span>customer_id\n<span class=\"token keyword\">having</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>order_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">4</span>\n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> orders_ct<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token punctuation\">;</span></code></pre></div>\n<p>select列表列出查询的返回最终结果集中需要显示哪些列，这些列可以是数据表中一个实际的列、一个表达式、<u>或者甚至是一个select语句的结果</u>。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> c<span class=\"token punctuation\">.</span>customer_id<span class=\"token punctuation\">,</span>\n       c<span class=\"token punctuation\">.</span>cust_first_name<span class=\"token operator\">||</span><span class=\"token string\">' '</span><span class=\"token operator\">||</span>c<span class=\"token punctuation\">.</span>cust_last_name<span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> e<span class=\"token punctuation\">.</span>last_name <span class=\"token keyword\">from</span> hr<span class=\"token punctuation\">.</span>employees e <span class=\"token keyword\">where</span> e<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>account_mgr_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> acct_mgr\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>customers c <span class=\"token punctuation\">;</span></code></pre></div>\n<h3>insert</h3>\n<p>insert语句用来向表、分区或视图中添加行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> hr<span class=\"token punctuation\">.</span>jobs j <span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>job_id<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>job_title<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>min_salary<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">.</span>max_salary<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">values</span><span class=\"token punctuation\">(</span><span class=\"token string\">'IT_PM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Project Manager'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">rollback</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> scott<span class=\"token punctuation\">.</span>bonus <span class=\"token punctuation\">(</span>ename<span class=\"token punctuation\">,</span> job<span class=\"token punctuation\">,</span> sal<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">select</span> ename<span class=\"token punctuation\">,</span>\n       job<span class=\"token punctuation\">,</span> \n       sal <span class=\"token operator\">*</span> <span class=\"token number\">.10</span>\n<span class=\"token keyword\">from</span> scott<span class=\"token punctuation\">.</span>emp <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- 多表插入</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">all</span>\n<span class=\"token keyword\">when</span> sum_orders <span class=\"token operator\">&lt;</span> <span class=\"token number\">10000</span> <span class=\"token keyword\">then</span>\n<span class=\"token keyword\">into</span> small_customers\n<span class=\"token keyword\">when</span> sum_orders <span class=\"token operator\">>=</span> <span class=\"token number\">10000</span> <span class=\"token operator\">and</span> sum_orders <span class=\"token operator\">&lt;</span> <span class=\"token number\">100000</span> <span class=\"token keyword\">then</span>\n<span class=\"token keyword\">into</span> medium_customers\n<span class=\"token keyword\">else</span>\n<span class=\"token keyword\">into</span> large_customers\n<span class=\"token keyword\">select</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>order_total<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sum_orders\n<span class=\"token keyword\">from</span> oe<span class=\"token punctuation\">.</span>orders\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> customer_id <span class=\"token punctuation\">;</span></code></pre></div>\n<h3>update</h3>\n<p>update语句的作用是改变表中原有行的列值。这个语句的语法由3个部分组成：update、set和where。update子句用来指定要更新的表，set子句用来指明哪些列改变了以及调整的值，where子句用来按条件筛选需要更新的行。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Example 1: Update a single column value using an expression</span>\n<span class=\"token keyword\">update</span> employees2\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> salary <span class=\"token operator\">*</span> <span class=\"token number\">1.10</span> <span class=\"token comment\">-- increase salary by 10%</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 2: Update a single column value using a subquery</span>\n<span class=\"token comment\">-- 可用于两表列数据同步</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> employees2<span class=\"token punctuation\">.</span>salary\n                <span class=\"token keyword\">from</span> employees2\n                <span class=\"token keyword\">where</span> employees2<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> employees<span class=\"token punctuation\">.</span>employee_id <span class=\"token comment\">-- 主键匹配</span>\n                <span class=\"token operator\">and</span> employees<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">!=</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">)</span> <span class=\"token comment\">--相同的不更新</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 3: Update single column using using subquery in WHERE clause to determine which rows to update</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> salary <span class=\"token operator\">*</span> <span class=\"token number\">1.10</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> department_id\n                          <span class=\"token keyword\">from</span> departments\n                          <span class=\"token keyword\">where</span> department_name <span class=\"token operator\">=</span> <span class=\"token string\">'EXecutive'</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 4: Update a table using a SELECT statement to define the table and column values</span>\n<span class=\"token keyword\">update</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> e1<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">,</span>\n               e2<span class=\"token punctuation\">.</span>salary <span class=\"token keyword\">as</span> new_sal<span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">from</span> employees e1<span class=\"token punctuation\">,</span> employees2 e2\n        <span class=\"token keyword\">where</span> e1<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> e2<span class=\"token punctuation\">.</span>employee_id\n          <span class=\"token operator\">and</span> e1<span class=\"token punctuation\">.</span>department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">set</span> salary <span class=\"token operator\">=</span> new_sal <span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Example 5: Update multiple columns using a subquery</span>\n<span class=\"token keyword\">update</span> employees\n<span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span>salary<span class=\"token punctuation\">,</span> commission_pct<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">,</span> <span class=\"token number\">.10</span> comm_pct\n                                  <span class=\"token keyword\">from</span> employees2\n                                  <span class=\"token keyword\">where</span> employees2<span class=\"token punctuation\">.</span>employee_id <span class=\"token operator\">=</span> employees<span class=\"token punctuation\">.</span>emloyee_id\n                                    <span class=\"token operator\">and</span> employees<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">!=</span> employees2<span class=\"token punctuation\">.</span>salary<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">where</span> department_id <span class=\"token operator\">=</span> <span class=\"token number\">90</span> <span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 比较Example 2、Example 4、Example 5。</span></code></pre></div>","frontmatter":{"title":"SQL-5个核心SQL语句","date":"2020年01月27日","description":"This is a custom description for SEO and Open Graph purposes, rather than the default generated excerpt. Simply add a description field to the frontmatter."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/SQL-5个核心SQL语句/","previous":{"fields":{"slug":"/红楼梦-贾宝玉范的两个病/"},"frontmatter":{"title":"宝玉范的两个病"}},"next":null}}}